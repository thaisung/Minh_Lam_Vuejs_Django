<template>
    <div class="bg-[#242424] w-full h-[90px] border-t-[1px] border-neutral-700 text-white">
        <div class="flex justify-between px-[25px] items-center w-full h-full gap-[50px] ">
            <div  class="flex gap-2 ">
                <img class=" h-[65px] rounded" :src="counter.Play_nhac.Photo"/>
                <div class="flex flex-col justify-start">
                    <h1 class="text-[15px]">{{ counter.Play_nhac.Name_song }}</h1>
                    <h1 class="text-[11px] text-gray-400">{{ counter.Play_nhac.Name_artist }}</h1>
                </div>
                <!-- <div v-show="counter.Play_nhac.Name_song !=''" class="my-[5px] ml-2">
                    <svg v-show="counter.Play_nhac.Tim==0" role="img" height="16" width="16" aria-hidden="true" viewBox="0 0 16 16" data-encore-id="icon" class="Svg-sc-ytk21e-0 gQUQL fill-gray-200"><path d="M1.69 2A4.582 4.582 0 0 1 8 2.023 4.583 4.583 0 0 1 11.88.817h.002a4.618 4.618 0 0 1 3.782 3.65v.003a4.543 4.543 0 0 1-1.011 3.84L9.35 14.629a1.765 1.765 0 0 1-2.093.464 1.762 1.762 0 0 1-.605-.463L1.348 8.309A4.582 4.582 0 0 1 1.689 2zm3.158.252A3.082 3.082 0 0 0 2.49 7.337l.005.005L7.8 13.664a.264.264 0 0 0 .311.069.262.262 0 0 0 .09-.069l5.312-6.33a3.043 3.043 0 0 0 .68-2.573 3.118 3.118 0 0 0-2.551-2.463 3.079 3.079 0 0 0-2.612.816l-.007.007a1.501 1.501 0 0 1-2.045 0l-.009-.008a3.082 3.082 0 0 0-2.121-.861z"></path></svg>
                    <svg v-show="counter.Play_nhac.Tim==1" role="img" height="16" width="16" aria-hidden="true" viewBox="0 0 16 16" data-encore-id="icon" class="Svg-sc-ytk21e-0 gQUQL absolute fill-green-500"><path d="M15.724 4.22A4.313 4.313 0 0 0 12.192.814a4.269 4.269 0 0 0-3.622 1.13.837.837 0 0 1-1.14 0 4.272 4.272 0 0 0-6.21 5.855l5.916 7.05a1.128 1.128 0 0 0 1.727 0l5.916-7.05a4.228 4.228 0 0 0 .945-3.577z"></path></svg>
                </div> -->
            </div>
            <audio   id="nhac" autoplay preload="metadata" @timeupdate='onTimeUpdateListener'   class="max-w-[600px] grow ">
                <source :src="counter.Play_nhac.URL" type="audio/mpeg">
                Your browser does not support the audio element.
            </audio>
            <div class="flex flex-col items-center justify-center gap-3">
                <div class="flex fill-gray-300 gap-5 justify-center items-center">
                    <svg v-on:click="counter.dao_ms=!counter.dao_ms" role="img" height="16" width="16" aria-hidden="true" viewBox="0 0 16 16" data-encore-id="icon" :class="{'fill-[#22c55e]':counter.dao_ms==true}" class="Svg-sc-ytk21e-0 uPxdw cursor-pointer"><path d="M13.151.922a.75.75 0 1 0-1.06 1.06L13.109 3H11.16a3.75 3.75 0 0 0-2.873 1.34l-6.173 7.356A2.25 2.25 0 0 1 .39 12.5H0V14h.391a3.75 3.75 0 0 0 2.873-1.34l6.173-7.356a2.25 2.25 0 0 1 1.724-.804h1.947l-1.017 1.018a.75.75 0 0 0 1.06 1.06L15.98 3.75 13.15.922zM.391 3.5H0V2h.391c1.109 0 2.16.49 2.873 1.34L4.89 5.277l-.979 1.167-1.796-2.14A2.25 2.25 0 0 0 .39 3.5z"></path><path d="m7.5 10.723.98-1.167.957 1.14a2.25 2.25 0 0 0 1.724.804h1.947l-1.017-1.018a.75.75 0 1 1 1.06-1.06l2.829 2.828-2.829 2.828a.75.75 0 1 1-1.06-1.06L13.109 13H11.16a3.75 3.75 0 0 1-2.873-1.34l-.787-.938z"></path></svg>
                    <svg v-on:click="giam_s();" role="img" height="16" width="16" aria-hidden="true" viewBox="0 0 16 16" data-encore-id="icon" class="Svg-sc-ytk21e-0 uPxdw cursor-pointer"><path d="M2.464 4.5h1.473a.75.75 0 1 1 0 1.5H0V2.063a.75.75 0 0 1 1.5 0v1.27a8.25 8.25 0 1 1 10.539 12.554.75.75 0 0 1-.828-1.25A6.75 6.75 0 1 0 2.464 4.5z"></path><path d="M.303 8.407c.79 0 1.214-.52 1.214-.907h1.5v8h-1.5V9.907H0v-1.5h.303zm4.832-.911h4.05v1.5H6.33l-.245 1.067c.256-.071.525-.11.804-.11 1.621 0 2.954 1.3 2.954 2.924C9.843 14.5 8.51 15.8 6.89 15.8a2.945 2.945 0 0 1-2.93-2.54l1.487-.197c.092.69.696 1.237 1.443 1.237.813 0 1.454-.647 1.454-1.423s-.64-1.423-1.454-1.423c-.49 0-.92.235-1.183.594l-.01.014-.206.254-1.314-.639.96-4.181z"></path></svg>
                    <svg role="img" height="16" width="16" aria-hidden="true" viewBox="0 0 16 16" data-encore-id="icon" class="Svg-sc-ytk21e-0 uPxdw "><path d="M3.3 1a.7.7 0 0 1 .7.7v5.15l9.95-5.744a.7.7 0 0 1 1.05.606v12.575a.7.7 0 0 1-1.05.607L4 9.149V14.3a.7.7 0 0 1-.7.7H1.7a.7.7 0 0 1-.7-.7V1.7a.7.7 0 0 1 .7-.7h1.6z"></path></svg>
                    <button class="flex items-center justify-center rounded-full bg-white w-[32px] h-[32px]">
                        <svg v-show="counter.Pause_Start==true" v-on:click="counter.Pause_Start=!counter.Pause_Start;Pause();" role="img" height="16" width="16" aria-hidden="true" viewBox="0 0 16 16" data-encore-id="icon" class="Svg-sc-ytk21e-0 uPxdw fill-black"><path d="M2.7 1a.7.7 0 0 0-.7.7v12.6a.7.7 0 0 0 .7.7h2.6a.7.7 0 0 0 .7-.7V1.7a.7.7 0 0 0-.7-.7H2.7zm8 0a.7.7 0 0 0-.7.7v12.6a.7.7 0 0 0 .7.7h2.6a.7.7 0 0 0 .7-.7V1.7a.7.7 0 0 0-.7-.7h-2.6z"></path></svg>
                        <svg v-show="counter.Pause_Start==false" v-on:click="counter.Pause_Start=!counter.Pause_Start; Play();" role="img" height="16" width="16" aria-hidden="true" viewBox="0 0 16 16" data-encore-id="icon" class="Svg-sc-ytk21e-0 uPxdw fill-black"><path d="M3 1.713a.7.7 0 0 1 1.05-.607l10.89 6.288a.7.7 0 0 1 0 1.212L4.05 14.894A.7.7 0 0 1 3 14.288V1.713z"></path></svg>
                    </button>
                    <svg role="img" height="16" width="16" aria-hidden="true" viewBox="0 0 16 16" data-encore-id="icon" class="Svg-sc-ytk21e-0 uPxdw"><path d="M12.7 1a.7.7 0 0 0-.7.7v5.15L2.05 1.107A.7.7 0 0 0 1 1.712v12.575a.7.7 0 0 0 1.05.607L12 9.149V14.3a.7.7 0 0 0 .7.7h1.6a.7.7 0 0 0 .7-.7V1.7a.7.7 0 0 0-.7-.7h-1.6z"></path></svg>
                    <svg v-on:click="tang_s();" role="img" height="16" width="16" aria-hidden="true" viewBox="0 0 16 16" data-encore-id="icon" class="Svg-sc-ytk21e-0 uPxdw cursor-pointer"><path d="M13.536 4.5h-1.473a.75.75 0 1 0 0 1.5H16V2.063a.75.75 0 0 0-1.5 0v1.27A8.25 8.25 0 1 0 3.962 15.887a.75.75 0 1 0 .827-1.25A6.75 6.75 0 1 1 13.535 4.5z"></path><path d="M6.303 8.407c.79 0 1.214-.52 1.214-.907h1.5v8h-1.5V9.907H6v-1.5h.303zm4.832-.911h4.05v1.5H12.33l-.245 1.067c.256-.071.525-.11.804-.11 1.621 0 2.954 1.3 2.954 2.924 0 1.624-1.333 2.923-2.954 2.923a2.945 2.945 0 0 1-2.93-2.54l1.487-.197c.092.69.696 1.237 1.443 1.237.813 0 1.454-.647 1.454-1.423s-.64-1.423-1.454-1.423c-.49 0-.92.235-1.183.594l-.01.014-.206.254-1.314-.639.96-4.181z"></path></svg>
                    <svg v-on:click="loop_ms()" role="img" height="16" width="16" aria-hidden="true" viewBox="0 0 16 16" data-encore-id="icon" :class="{'fill-[#22c55e]':counter.loop_ms==true}" class="Svg-sc-ytk21e-0 uPxdw cursor-pointer"><path d="M0 4.75A3.75 3.75 0 0 1 3.75 1h8.5A3.75 3.75 0 0 1 16 4.75v5a3.75 3.75 0 0 1-3.75 3.75H9.81l1.018 1.018a.75.75 0 1 1-1.06 1.06L6.939 12.75l2.829-2.828a.75.75 0 1 1 1.06 1.06L9.811 12h2.439a2.25 2.25 0 0 0 2.25-2.25v-5a2.25 2.25 0 0 0-2.25-2.25h-8.5A2.25 2.25 0 0 0 1.5 4.75v5A2.25 2.25 0 0 0 3.75 12H5v1.5H3.75A3.75 3.75 0 0 1 0 9.75v-5z"></path></svg>
                </div>
                <!-- <h1 class="text-gray-200">{{ counter.loop_ms }}</h1> -->
                <div class="flex gap-2 items-center justify-center">
                    <h1 id="tracktime" class="player-time player-time-current text-gray-400 font-normal text-[12px] mb-1">{{counter.current}}</h1>
                    <div class=" player-progress h-[5px] rounded bg-gray-500 cursor-pointer w-[600px] relative">
                        <div class=" player-progress-filled h-[5px] bg-gray-100  rounded " :style="'width:'+counter.current_mp3/counter.duration_mp3*100+'%'"></div>
                        <input v-on:click="update_vl1()" type="range" min="0" max="100" :value="counter.do_dai" class=" absolute z-30 top-0 bottom-0 left-0 right-0 slider h-[5px] bg-[#d3d3d3] rounded opacity-0 hover:opacity-100" id="myRange1">
                    </div>
                    <h1 id="tracktime1" class="player-time player-time-duration text-gray-400 font-normal text-[12px] mb-1">{{ counter.length }}</h1>
                </div>
            </div>
            <div class="flex fill-gray-300 gap-3 justify-center items-center">
                <svg role="img" height="16" width="16" aria-hidden="true" viewBox="0 0 16 16" data-encore-id="icon" class="Svg-sc-ytk21e-0 uPxdw"><path d="M15 15H1v-1.5h14V15zm0-4.5H1V9h14v1.5zm-14-7A2.5 2.5 0 0 1 3.5 1h9a2.5 2.5 0 0 1 0 5h-9A2.5 2.5 0 0 1 1 3.5zm2.5-1a1 1 0 0 0 0 2h9a1 1 0 1 0 0-2h-9z"></path></svg>
                <svg role="presentation" height="16" width="16" aria-hidden="true" class="Svg-sc-ytk21e-0 uPxdw" viewBox="0 0 16 16" data-encore-id="icon"><path d="M6 2.75C6 1.784 6.784 1 7.75 1h6.5c.966 0 1.75.784 1.75 1.75v10.5A1.75 1.75 0 0 1 14.25 15h-6.5A1.75 1.75 0 0 1 6 13.25V2.75zm1.75-.25a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25h6.5a.25.25 0 0 0 .25-.25V2.75a.25.25 0 0 0-.25-.25h-6.5zm-6 0a.25.25 0 0 0-.25.25v6.5c0 .138.112.25.25.25H4V11H1.75A1.75 1.75 0 0 1 0 9.25v-6.5C0 1.784.784 1 1.75 1H4v1.5H1.75zM4 15H2v-1.5h2V15z"></path><path d="M13 10a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm-1-5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"></path></svg>
                <div class="flex gap-1 justify-center items-center relative">
                    <svg role="presentation" height="16" width="16" aria-hidden="true" aria-label="Volume high" id="volume-icon" viewBox="0 0 16 16" data-encore-id="icon" class="Svg-sc-ytk21e-0 uPxdw"><path d="M9.741.85a.75.75 0 0 1 .375.65v13a.75.75 0 0 1-1.125.65l-6.925-4a3.642 3.642 0 0 1-1.33-4.967 3.639 3.639 0 0 1 1.33-1.332l6.925-4a.75.75 0 0 1 .75 0zm-6.924 5.3a2.139 2.139 0 0 0 0 3.7l5.8 3.35V2.8l-5.8 3.35zm8.683 4.29V5.56a2.75 2.75 0 0 1 0 4.88z"></path><path d="M11.5 13.614a5.752 5.752 0 0 0 0-11.228v1.55a4.252 4.252 0 0 1 0 8.127v1.55z"></path></svg>
                    <div class="h-[5px] rounded bg-gray-500 cursor-pointer w-[100px] relative">
                        <div class="h-[5px] bg-gray-100  rounded" :style="'width:'+ counter.am_luong+'%'">
                        <input v-on:click="update_vl()" type="range" min="0" max="10" value="5" class=" absolute z-30 top-0 bottom-0 left-0 right-0 slider h-[5px] bg-[#d3d3d3] rounded opacity-0 hover:opacity-100" id="myRange">
                    </div>
                </div>
                </div>
            </div>
        </div>
    </div>
</template>


<script>
    import { useCounterStore } from '@/stores/counter';
    import axios from 'axios';
    import VueCookies from 'vue-cookies'


    export default {

    setup() {
        const counter = useCounterStore();
        return {counter}
    },
    mounted: function () {
        this.update_vl();
    },
    methods:{
        Play(){
            var audio = document.getElementById("nhac");
            // audio.load();
            audio.play();
        },
        Pause(){
            var audio = document.getElementById("nhac");
            // audio.load();
            audio.pause();
        },
        onTimeUpdateListener: function() {
        var audio = document.getElementById("nhac");
        this.counter.current_mp3= Math.floor(audio.currentTime);
        if(this.counter.current_mp3%60 >= 10){
            this.counter.current = Math.floor(this.counter.current_mp3/60) + ':' + (this.counter.current_mp3%60)
            }
            else{
                this.counter.current = Math.floor(this.counter.current_mp3/60) + ':0' + (this.counter.current_mp3%60)
            };
            this.counter.do_dai = Math.floor(this.counter.current_mp3*100/this.counter.duration_mp3);
        },
        update_vl(){
            var slider = document.getElementById("myRange");
            // output.innerHTML = slider.value;
            this.counter.am_luong = slider.value*10;
            var audio = document.getElementById("nhac");
            audio.volume = slider.value/10;
        },
        update_vl1(){
            var slider1 = document.getElementById("myRange1");
            // output.innerHTML = slider.value;
            this.counter.do_dai = slider1.value;
            var audio = document.getElementById("nhac");
            audio.currentTime =  Math.floor(this.counter.do_dai*this.counter.duration_mp3/100);

        },
        tang_s(){
            var slider1 = document.getElementById("myRange1");
            // output.innerHTML = slider.value;
            this.counter.do_dai = slider1.value;
            var audio = document.getElementById("nhac");
            audio.currentTime =  Math.floor(this.counter.do_dai*(this.counter.duration_mp3+15)/100);
        },
        giam_s(){
            var slider1 = document.getElementById("myRange1");
            // output.innerHTML = slider.value;
            this.counter.do_dai = slider1.value;
            var audio = document.getElementById("nhac");
            audio.currentTime =  Math.floor(this.counter.do_dai*(this.counter.duration_mp3-15)/100);
        },
        loop_ms(){
            this.counter.loop_ms =! this.counter.loop_ms;
            document.getElementById("nhac").loop = this.counter.loop_ms;
        }
    }
    }
</script>

<style>
    progress {
    accent-color: red;
    }

    .slider {
  -webkit-appearance: none;
  width: 100%;
  height: 5px;
  border-radius: 5px;  
  background: #d3d3d3;
  outline: none;
  -webkit-transition: .2s;
  transition: opacity .2s;
}
    .slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 13px;
  height: 13px;
  border-radius: 50%; 
  background: #f3f4f6;
  cursor: pointer;
}
.slider::-moz-range-thumb {
  width: 13px;
  height: 5px;
  border-radius: 50%;
  background: #6b7280;
  cursor: pointer;
}

.slider1 {
  -webkit-appearance: none;
  width: 100%;
  height: 5px;
  border-radius: 5px;  
  background: #d3d3d3;
  outline: none;
  -webkit-transition: .2s;
  transition: opacity .2s;
}
    .slider1::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 13px;
  height: 13px;
  border-radius: 50%; 
  background: #f3f4f6;
  cursor: pointer;
}
.slider1::-moz-range-thumb {
  width: 13px;
  height: 5px;
  border-radius: 50%;
  background: #6b7280;
  cursor: pointer;
}
/* .slider::-webkit-slider-runnable-track {
  height: 5px;
  border-radius: 50%;
  background: #6b7280;
  cursor: pointer;
} */
</style>